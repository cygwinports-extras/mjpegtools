--- origsrc/mjpegtools-1.9.0rc3/cpuinfo.sh	2007-10-07 01:58:19.000000000 -0500
+++ src/mjpegtools-1.9.0rc3/cpuinfo.sh	2008-04-25 19:30:01.109375000 -0500
@@ -21,7 +21,7 @@
 _cc_major=`echo $cc_version | cut -d'.' -f1`
 _cc_minor=`echo $cc_version | cut -d'.' -f2`
 
-if test $_cc_major -ge 4; then
+if test $_cc_major -ge 4 || test $_cc_major -eq 3 -a $_cc_minor -ge 4; then
   _opt_mcpu="-mtune"
 else
   _opt_mcpu="-mcpu"
--- origsrc/mjpegtools-1.9.0rc3/docs/mjpeg-howto.info	2007-12-03 12:06:25.000000000 -0600
+++ src/mjpegtools-1.9.0rc3/docs/mjpeg-howto.info	2008-04-25 19:30:01.109375000 -0500
@@ -1,3 +1,4 @@
+INFO-DIR-SECTION Miscellaneous
 START-INFO-DIR-ENTRY
 * mjpegtools: (mjpeg-howto).       command line tools for MPEG audio and video.
 END-INFO-DIR-ENTRY
--- origsrc/mjpegtools-1.9.0rc3/lavtools/Makefile.am	2007-11-08 11:32:20.000000000 -0600
+++ src/mjpegtools-1.9.0rc3/lavtools/Makefile.am	2008-04-25 19:30:01.125000000 -0500
@@ -35,6 +35,7 @@
 
 LAV_ALL_LIB_OPTS = \
 	$(LT_STATIC) \
+	-no-undefined \
 	-version-info $(LT_CURRENT):$(LT_REVISION):$(LT_AGE) \
 	-release $(LT_RELEASE) $(EXTRA_LDFLAGS)
 
--- origsrc/mjpegtools-1.9.0rc3/mpeg2enc/Makefile.am	2007-02-26 11:05:48.000000000 -0600
+++ src/mjpegtools-1.9.0rc3/mpeg2enc/Makefile.am	2008-04-25 19:30:01.140625000 -0500
@@ -73,6 +73,7 @@
 
 libmpeg2encpp_la_LDFLAGS = \
 	${LT_STATIC} \
+	-no-undefined \
 	-version-info $(LT_CURRENT):$(LT_REVISION):$(LT_AGE) \
 	-release $(LT_RELEASE) ${EXTRA_LDFLAGS}
 
--- origsrc/mjpegtools-1.9.0rc3/mpeg2enc/ontheflyratectl.cc	2007-11-01 13:44:11.000000000 -0500
+++ src/mjpegtools-1.9.0rc3/mpeg2enc/ontheflyratectl.cc	2008-04-25 19:30:01.156250000 -0500
@@ -369,7 +369,7 @@
 	   limit any individual frame to 3/4's of the buffer.
 	*/
 
-	target_bits = min( target_bits, encparams.video_buffer_size*3/4 );
+	target_bits = min( static_cast<int>(target_bits), encparams.video_buffer_size*3/4 );
 
  	mjpeg_debug( "Frame %c T=%05d A=%06d  Xi=%.2f Xp=%.2f Xb=%.2f", 
                  pict_type_char[picture.pict_type],
@@ -901,7 +901,7 @@
   // Work out target bit allocation of frame based complexity statistics
   double Xhi = picture.ABQ * picture.EncodedSize(); 
   target_bits = static_cast<int32_t>(available_bits*Xhi/gop_Xhi);
-  target_bits = min( target_bits, encparams.video_buffer_size*3/4 );
+  target_bits = min( static_cast<int>(target_bits), encparams.video_buffer_size*3/4 );
 
 
   //mjpeg_info( "P2RC: %d bv=%d av=%.0f xhi=%.0f/%.0f", picture.decode,
--- origsrc/mjpegtools-1.9.0rc3/mpeg2enc/pass1ratectl.cc	2007-02-26 11:05:48.000000000 -0600
+++ src/mjpegtools-1.9.0rc3/mpeg2enc/pass1ratectl.cc	2008-04-25 19:30:01.171875000 -0500
@@ -355,7 +355,7 @@
        limit any individual frame to 3/4's of the buffer.
     */
 
-    target_bits = min( target_bits, encparams.video_buffer_size*3/4 );
+    target_bits = min( static_cast<int>(target_bits), encparams.video_buffer_size*3/4 );
 
     mjpeg_debug( "Frame %c T=%05d A=%06d  Xi=%.2f Xp=%.2f Xb=%.2f", 
                  pict_type_char[picture.pict_type],
--- origsrc/mjpegtools-1.9.0rc3/mpeg2enc/pass2ratectl.cc	2007-02-26 11:05:48.000000000 -0600
+++ src/mjpegtools-1.9.0rc3/mpeg2enc/pass2ratectl.cc	2008-04-25 19:30:01.234375000 -0500
@@ -241,7 +241,7 @@
     // Work out base quantisation of frame based on feedback on bits consumed
     double Xhi = picture.Complexity();
     target_bits = static_cast<int32_t>(available_bits*Xhi/gop_Xhi);
-    target_bits = min( target_bits, encparams.video_buffer_size*3/4 );
+    target_bits = min( static_cast<int>(target_bits), encparams.video_buffer_size*3/4 );
     base_quant = fmax( encparams.quant_floor, Xhi/target_bits );
 
 
--- origsrc/mjpegtools-1.9.0rc3/mplex/Makefile.am	2007-02-26 11:05:49.000000000 -0600
+++ src/mjpegtools-1.9.0rc3/mplex/Makefile.am	2008-04-25 19:30:01.250000000 -0500
@@ -64,6 +64,7 @@
 
 libmplex2_la_LDFLAGS =  \
 	$(LT_STATIC) \
+	-no-undefined \
 	-version-info $(LT_CURRENT):$(LT_REVISION):$(LT_AGE) \
 	-release $(LT_RELEASE) $(EXTRA_LDFLAGS)
 
--- origsrc/mjpegtools-1.9.0rc3/utils/Makefile.am	2007-08-09 06:50:03.000000000 -0500
+++ src/mjpegtools-1.9.0rc3/utils/Makefile.am	2008-04-25 19:30:01.265625000 -0500
@@ -26,6 +26,7 @@
 
 libmjpegutils_la_LDFLAGS = \
 	$(LT_STATIC) \
+	-no-undefined \
 	-version-info $(LT_CURRENT):$(LT_REVISION):$(LT_AGE) \
 	-release $(LT_RELEASE) $(EXTRA_LDFLAGS)
 
--- origsrc/mjpegtools-1.9.0rc3/y4mdenoise/Limits.hh	2004-04-27 15:45:56.000000000 -0500
+++ src/mjpegtools-1.9.0rc3/y4mdenoise/Limits.hh	2008-04-25 19:30:01.281250000 -0500
@@ -67,6 +67,10 @@
 	= uint64_t (0xffffffffffffffffULL);
 template <> int Limits<uint64_t>::Bits = 64;
 template <> int Limits<uint64_t>::Log2Bits = 6;
+template <> unsigned int Limits<unsigned int>::Min = uint32_t (0x00000000);
+template <> unsigned int Limits<unsigned int>::Max = uint32_t (0xffffffff);
+template <> int Limits<unsigned int>::Bits = 32;
+template <> int Limits<unsigned int>::Log2Bits = 5;
 
 
 
